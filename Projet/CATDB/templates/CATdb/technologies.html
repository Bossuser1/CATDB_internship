{% load staticfiles %}
<html>

<script src="https://code.jquery.com/jquery-1.10.2.js"></script>

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="{% static "css/main.css" %}"/>
<script src="{% static "js/dg.js" %}"></script>
<style>
.showcard2{
width: 40%;
padding: 30px;
background-color: white;
margin: 3px;
box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
transition: 0.3s;
position: relative;
overflow: auto;
}

.showcard3{
width: 100%	;
padding: 30px;
background-color: white;
margin: 3px;
box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
transition: 0.3s;
position: relative;
overflow: scroll;
}

#grid_answ{
display:grid;
position:absolute;
top:0px;
left:0px; 
}

#grid_show_card{
display:grid;
/*position:absolute;
top:0px;
left:0px;*/ 
}
.insider_cell{
overflow: hidden;
/*border: 1px solid;
border-color: #dbdee9;*/
}
.head_cell{
overflow: hidden;
	border: 1px solid;
	font-weight: bold;
	background-color: #efefef;
}
.foot_cell{
	border-bottom: 1px solid;
}
.foot_cell1{
	border-bottom: 1px solid;
	border-top: 1px solid;
	background-color: #efefef;
}

.imag_card1 {
    width: 100%;
    height: 100%;
}

.imag_labelcard1 {

}

</style>

  <body>
    <section id="welcome">
      <h2><img src="http://tools.ips2.u-psud.fr/projects/transcriptome/CATdb_style/catdb_logo.png"></h2>
      <p>Complete Arabidopsis Transcriptome database</p>
      <span class="fa fa-chevron-circle-down fa-5x" aria-hidden="true" id="go"></span>
    </section>
    <nav classname="sticky" id="header">
<div>
      <div id="headmain_banner">
          <div class="hedclean">
              <img src="http://tools.ips2.u-psud.fr/logos/logo-ips2-trans.png"> <!-- Images -->
          </div>
          <div class="hedclean">
              <img src="http://tools.ips2.u-psud.fr/projects/transcriptome/CATdb_style/catdb_logo.png" id="catdb_img">
              <!-- Images -->
          </div>
          <div class="hedclean">
              <img src="http://tools.ips2.u-psud.fr/projects/GEM2NET/logos/GEM2NET_logo5_transpa.png"> <!-- Images -->
          </div>

      </div>

  </div>
    </nav>
    <section id="about">
    <div class="main_about">
        <div>
            <div class="main_show_card">
              <div class="row1_main_show_card">  
              <div class="showcard2"> 
                <div class="imag_card1"> 
                <img src="https://it.mathworks.com/help/examples/graphics/win64/SingleDataSeriesExample_01.png" style="width: 100%;height: 100%;">
                </div>
                <div class="imag_labelcard1">
                	Source:Image
                </div>  
             </div>
              <!-- Show -->
             
              <div class="showcard2" style="margin: auto;"> 

				<div id="grid_show_card" >
				
				</div>


                
             </div>    

              </div> 
              
              <div class="row1_main_show_card">  
            
              <div class="showcard3"> 
				<div id="grid_answ">
				
				</div>
			
             </div>


            </div>
                
            
            </div>


        </div>


    </div>

</section>
<div id="conteneur_feeds">    
<div id="feedback" style="color: white;font-weight: bold;">
	Feedback
</div>    
</div>    
  </body>
  
  <script type="text/javascript">

  var body = $('html, body');

  $('#go').click(function(e){
      e.preventDefault();
      body.animate({scrollTop:850}, 1000, 'swing');

	}); 
  
  var about = "#ffffff",
	work = "#ffffff"

var init_header_position = $('#header').offset().top

$(window).on("scroll touchmove", function() {
var header = $('#header')
scroll = $(window).scrollTop()+300;
      //console.log(init_header_position)
    //console.log(scroll)
if (scroll >= init_header_position){
  header.removeClass('sticky');
  header.addClass('fixed');
  
$('#catdb_img').show();
} else {
  header.removeClass('fixed');
  header.addClass('sticky');
  $('#header').css('background-color',      "#FFF") ;
$('#catdb_img').hide();
}

if (scroll >= $("#welcome").position().top) {
$('#header').css('background-color', welcome)
} 
if (scroll > $("#about").position().top) {
$('#header').css('background-color', about)
} 
//if (scroll > $("#work").position().top) {
//$('#header').css('background-color', work)
//};
});


//###########################****
  
//$('.main_show_card:eq(0)').width($(window).width(););
var h=$(window).width();
$('.main_show_card:eq(0)').css("width", h+"px");

$('.description_card:eq(1)').css("height", $('.description_card:eq(0)').height()+"px");
$('.description_card:eq(2)').css("height", $('.description_card:eq(0)').height()+"px");
$('.description_card:eq(3)').css("height", $('.description_card:eq(0)').height()+"px");
$('.description_card:eq(4)').css("height", $('.description_card:eq(0)').height()+"px");
$('.description_card:eq(5)').css("height", $('.description_card:eq(0)').height()+"px");

$(window).on("scroll touchmove", function() {
	position=$(window).scrollTop()+($(window).height())/5;
	$("#conteneur_feeds").attr('style',"right: -1.6%;top: "+position+"px;cursor: pointer;position: absolute;z-index: 2100000000;background: #747272;transform: rotateZ(-90deg);border-style: inset;");
});

// pour la taille des elements
$('.showcard2:eq(0)').css("height",($(window).height()/7)+"px");
$('.showcard2:eq(1)').css("height",($(window).height()/7)+"px");

$('.showcard3:eq(0)').css("height",($(window).height()/6)+"px");

//
//$('.main_show_card .showcard')


function make_grid(Data,tagid,classid,max_val,option){
	$('#'+tagid).empty();
	//LoadGrid(Data,'grid_show_card','showcard2',9,option);
	LoadGrid(Data,tagid,classid,max_val,option);
	LoadGridevent(tagid,classid);
	return Data;	
};


/* function for sorted data json  */
function dynamicSort(property) {
    var sortOrder = 1;

    if(property[0] === "-") {
        sortOrder = -1;
        property = property.substr(1);
    }

    return function (a,b) {
        if(sortOrder == -1){
            return b[property].localeCompare(a[property]);
        }else{
            return a[property].localeCompare(b[property]);
        }        
    }
}

//Dataload1,"percentage"
function arrangementdata(data,keys){
	var Data=[];
	var datasort=[];
	for (var i=0;i<Object.keys(data).length;i++){
	    //try{console.log(Dataload1[Object.keys(Dataload1)[i]]._value);}catch{};
	    try{datasort.push(Dataload1[Object.keys(data)[i]]._value);}catch{};
	};

	var datasort_tru=datasort.sort(dynamicSort(keys));
	for (var i=0;i<datasort_tru.length;i++){
	Data.push({"_key":i+1,"_value":datasort_tru[i]});
	};
	return Data;
};

function variable_name(value){
	var answer="";
	if (value==='grid_answ'){var answer="Dataload_init1"};
	if (value==='grid_show_card'){var answer="Dataload_init2"};
	return answer;	
	};






var Dataload_init1=DG_execQuery('all_experiment','select','');//all_experiment,type_analysis

make_grid(Dataload_init1,'grid_answ','showcard3',8,'');



var Dataload_init2=DG_execQuery('TagRNas_vs_analys','select','');//all_experiment,type_analysis
var option={'col_odrer':['analysis_type','count','percentage']};

make_grid(Dataload_init2,'grid_show_card','showcard2',9,option);


function actionclick(clef){
$('.fas.fa-sort-up').on("click",function(){

var id=$(this).parent('div').attr('id');
var grid_current=id.split('-')[0].replace('ligne','');
var colname_sorted=$('#'+id).html().split('<')[0];

//console.log(clef.split('#')[0]);
var dataname=variable_name(clef.split('#')[0]);
make_grid(arrangementdata(eval(dataname),colname_sorted),clef.split('#')[0],clef.split('#')[1],9,option);

});

$('.fas.fa-sort-down').on("click",function(){
var id=$(this).parent('div').attr('id');
var grid_current=id.split('-')[0].replace('ligne','');
var colname_sorted=$('#'+id).html().split('<')[0];

var dataname=variable_name(clef.split('#')[0]);
make_grid(arrangementdata(eval(dataname),'-'+colname_sorted),clef.split('#')[0],clef.split('#')[1],9,option);

});
};

</script>
  
  
</html>
